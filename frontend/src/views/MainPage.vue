<template>
  <v-carousel
    class="banner"
    delimiter-icon="mdi-minus"
    show-arrows="hover"
    cycle
    interval="3000"
    height="60vh"
  >
    <v-carousel-item>
      <img src="@/assets/img/banner-1.png" alt="í•´ë‹¬ í™ë³´ ë°°ë„ˆ"
    /></v-carousel-item>
    <v-carousel-item
      ><img src="@/assets/img/banner-2.png" alt="í•´ë‹¬ ìƒí’ˆ í™ë³´ ë°°ë„ˆ"
    /></v-carousel-item>
    <v-carousel-item
      ><img src="@/assets/img/banner-3.png" alt="í•´ë‹¬ í¬íŠ¸í´ë¦¬ì˜¤ í™ë³´ ë°°ë„ˆ"
    /></v-carousel-item>
  </v-carousel>
  <div style="text-align: center">
    <!-- <v-divider :thickness="3" color="info" style="width:30%;     border-style: double;
    margin: auto; margin-top:100px;"></v-divider> -->
    <p
      style="
        margin-top: 170px;
        margin-bottom: 40px;
        color: rgba(0, 179, 255, 0.826);
        font-size: 30px;
        font-weight: 600;
      "
    >
      âœ¨ í•´ë‹¬ì˜ ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìƒí’ˆ âœ¨
    </p>
    <v-card
      class="recommend"
      style="
        width: 50%;
        height: 10%;
        margin: auto;
        margin-bottom: 180px;
        color: rgb(0, 63, 90);
        border-radius: 30px;
        vertical-align: middle !important;
      "
    >
      <div>
        <div class="text-h5 mb-3" style="font-weight: bolder">
          {{ recommend.productName }}
        </div>
        <div class="text-overline mb-3">
          <span>
            <b>ìƒí’ˆ ê¸°ê°„</b> {{ recommend.period }}ê°œì›”, <b>ê¸ˆë¦¬</b>
            {{ recommend.interestRate }}%, <b>ìµœì†Œ ê°€ì… ê¸ˆì•¡</b>
            {{ recommend.requiredStartMoney }}ì›
          </span>
          <div style="font-size: 14px; font-weight: bold">
            "{{ recommend.shortInfo }}ìƒí’ˆ"
          </div>
        </div>
        <v-btn
          @click="detail(recommend)"
          style="
            background: rgba(0, 179, 255, 0.826);
            color: white;
            font-weight: bold;
            border-radius: 15px;
            width: 200px;
            height: 40px;
          "
          >ì¶”ì²œ ìƒí’ˆ ì •ë³´ ë³´ê¸°</v-btn
        >
      </div>
    </v-card>
  </div>
  <div
    style="
      text-align: center;
      margin: 60px 0rem -10px 0rem;
      font-weight: 600;
      height: 300vh;
    "
  >
    <div
      style="
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: -50px;
        background-color: rgba(0, 179, 255, 0.158);
        height: 100vh;
        margin-top: 90px;
      "
    >
      <div style="display: flex; flex-direction: column; align-items: center">
        <div
          style="
            margin-bottom: 40px;
            margin-top: -80px;
            background-color: white;
            border-radius: 100%;
            text-align: center;
            font-size: 50px;
            width: 100px;
            height: 100px;
            padding: 10px;
          "
        >
          ğŸš
        </div>
        <p
          style="
            color: rgba(0, 179, 255, 0.826);
            line-height: 150%;
            font-size: 50px;
          "
        >
          í•´ë‹¬ê³¼ í•¨ê»˜<br />í•´ì™€ ë‹¬ì´ ëœ¨ê³  ì§€ë“¯ ê¾¸ì¤€íˆ ì €ì¶•í•´ë³´ì„¸ìš”!
        </p>
      </div>
    </div>

    <div style="height: 100vh">
      <p style="font-size: 24px; font-weight: 500; margin-top: 160px">
        ê¾¸ì¤€íˆ ì¡°ê°œë¥¼ ëª¨ìœ¼ëŠ” í•´ë‹¬ì´ ì—¬ëŸ¬ë¶„ì˜ ì €ì¶•ì„ ë„ì™€ë“œë¦´ê²Œìš”!
      </p>
      <div
        style="margin: auto; display: flex; justify-content: center; width: 70%"
      >
        <img
          src="@/assets/img/main-image1.png"
          class="first-image"
          alt="í•´ë‹¬ ì¶”ì²œìƒí’ˆ ê¸°ëŠ¥ í™ë³´ ì´ë¯¸ì§€"
        />
      </div>
      <p
        style="
          font-size: 18px;
          color: balck;
          font-weight: 500;
          line-height: 200%;
          margin-bottom: 100px;
        "
      >
        í•´ë‹¬ì´ ì¶”ì²œí•´ë“œë¦¬ëŠ”<br />
        <span
          style="
            font-size: 20px;
            color: rgb(0, 179, 255);
            background-color: rgba(0, 179, 255, 0.158);
            font-weight: bolder;
            padding: 3px;
          "
          >"ì—¬ëŸ¬ë¶„ì—ê²Œ ë”± ë§ëŠ” ìƒí’ˆ"</span
        >ì„ ë§Œë‚˜ë³´ì„¸ìš”.
      </p>
      <div style="background: rgba(238, 244, 248, 0.457)">
        <img
          src="@/assets/img/haedal-mockup.png"
          class="mockup"
          alt="í•´ë‹¬ ëª©ì—… ì´ë¯¸ì§€"
        />
      </div>
      <div>
        <p
          style="
            margin: 150px 0px 60px 0px;
            color: rgba(0, 179, 255, 0.826);
            font-size: 40px;
          "
        >
          ì§€ê¸ˆ ì‹œì‘í•´ ë³´ì„¸ìš”!
        </p>
        <v-btn
          style="
            background: rgba(0, 179, 255, 0.826);
            color: white;
            font-weight: bold;
            border-radius: 30px;
            margin-bottom: 1rem;
            width: 400px;
            height: 60px;
            font-size: 20px;
          "
          href="/products"
          >ìƒí’ˆ ë³´ëŸ¬ê°€ê¸°</v-btn
        >
      </div>
    </div>
  </div>
  <div
    style="
      background: linear-gradient(
        to top,
        rgba(0, 162, 255, 0.354),
        rgba(255, 255, 255, 0)
      );
      height: 180px;
      margin-top: 500px;
      display: block;
    "
  ></div>
</template>

<script setup>
import axios from "axios";
import { watchEffect, ref, onMounted } from "vue";
import router from "../router";
import { mdiConsoleNetwork } from "@mdi/js";

// Axios ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
const axiosInstance = axios.create({
  baseURL: "https://backend.haedal.store", // ì„œë²„ì˜ ì£¼ì†Œ
  // baseURL: 'http://15.164.189.153:8080',
});

// ì„œë²„ì—ì„œ ë°›ì•„ì˜¤ëŠ” ì •ë³´
const listData = ref([]);
const recommend = ref({});
// ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
function fetchData() {
  axiosInstance.get("/products").then((res) => {
    let tempArr = [...res.data];
    tempArr.forEach((item) => {
      listData.value.push(item);
    });
    // console.log(listData)
    recommend.value =
      listData.value[Math.floor(Math.random() * listData.value.length)];
    // console.log(recommend.value)

    // ë°ì´í„°ë¥¼ Local Storageì— ì €ì¥
    localStorage.setItem("data", JSON.stringify(recommend.value));
  });
}

// í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ Local Storageì—ì„œ ë°ì´í„°ë¥¼ ë¡œë“œ
onMounted(() => {
  const storedData = localStorage.getItem("data");
  if (storedData) {
    // Local Storageì— ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°, ì €ì¥ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©
    recommend.value = JSON.parse(storedData);
    // console.log(recommend.value)
  } else {
    // Local Storageì— ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°, ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ì €ì¥
    fetchData();
  }

  // ì˜¤ì „ 12ì‹œì— ì£¼ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸
  setInterval(() => {
    const now = new Date();
    if (now.getHours() === 0 && now.getMinutes() === 0) {
      fetchData();
    }
  }, 60000); // 1ë¶„ë§ˆë‹¤ ì²´í¬ (ì¡°ì ˆ ê°€ëŠ¥)
});

//ì¶”ì²œ ìƒí’ˆ ìƒì„¸ ì •ë³´ ë³´ê¸° ë²„íŠ¼
const detail = (item) => {
  const productId = item.productId;
  const productName = item.productName;
  // console.log(productName);
  // console.log(item.deposit);
  if (item.deposit == true) {
    router.push({
      name: "subscribeD",
      params: {
        id: productId,
      },
    });
  } else if (item.deposit == false) {
    router.push({
      name: "subscribeI",
      params: {
        id: productId,
      },
    });
  }
};
</script>

<style>
.v-carousel__controls {
  background: none !important;
}

.first-image {
  width: 80%;
  height: 100%;
  object-fit: cover;
  box-shadow: none !important;
}

.recommend {
  box-shadow: -4px 5px 20px 0 rgba(51, 96, 133, 0.122),
    12px -12px 16px rgba(255, 255, 255, 0.25) !important;
  padding: 40px !important;
  justify-content: center;

  &:hover {
    transition: transform 0.5s ease;
    transform: scale(1.05);
    box-shadow: -5px 5px 20px 0 rgba(0, 179, 255, 0.264),
      12px -12px 16px rgba(0, 179, 255, 0.046) !important;
  }
}

.banner {
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.banner img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.mockup {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  /* ì´ë¯¸ì§€ë¥¼ ë¸”ë¡ ë ˆë²¨ ìš”ì†Œë¡œ ì„¤ì • */
  margin: 0 auto;
  /* ê°€ìš´ë° ì •ë ¬ (ì„ íƒ ì‚¬í•­) */
}

.recommend b {
  background-color: rgba(0, 179, 255, 0.264);
  padding: 3px 6px;
  border-radius: 20px;
  color: rgba(0, 68, 128, 0.826);
}

.v-btn--size-x-small {
  color: rgba(0, 179, 255, 0.696) !important;
  margin-top: 20px;
  font-size: 20px !important;
}
</style>
